py2:
    box: python:2
    build:
        steps:
            - install-packages:
                packages: libnss3

            - script:
                name: Linting
                code: |
                    pip install flake8
                    flake8

            - script:
                name: Run tests
                code: |
                    cd tests
                    ./run_all -v

py3:
    box: python:3
    build:
        steps:
            - install-packages:
                packages: libnss3

            - script:
                name: Linting
                code: |
                    pip install flake8
                    flake8

            - script:
                name: Run tests
                code: |
                    cd tests
                    ./run_all -v


debian-stable:
    box: debian:stable
    build:
        steps:
            - install-packages:
                packages: python libnss3

            - script:
                name: Run tests
                code: |
                    cd tests
                    ./run_all -v

debian-testing:
    box: debian:testing
    build:
        steps:
            - install-packages:
                packages: python libnss3

            - script:
                name: Run tests
                code: |
                    cd tests
                    ./run_all -v

debian-unstable:
    box: debian:unstable
    build:
        steps:
            - install-packages:
                packages: python libnss3

            - script:
                name: Run tests
                code: |
                    cd tests
                    ./run_all -v

fedora:
    box: fedora:latest
    build:
        steps:
            - script:
                name: Install packages
                code: dnf install python nss -y

            - script:
                name: Run tests
                code: |
                    cd tests
                    ./run_all -v

centos:
    box: centos:latest
    build:
        steps:
            - script:
                name: Install packages
                code: yum install python nss -y

            - script:
                name: Run tests
                code: |
                    cd tests
                    ./run_all -v

alpine:
    box:
        id: alpine:latest
        cmd: /bin/sh
    build:
        steps:
            - internal/docker-push:
                disable-sync: true

            - script:
                name: Install packages
                code: |
                    apk update
                    apk add python nss

            - script:
                name: Run tests
                code: |
                    cd tests
                    ./run_all -v
